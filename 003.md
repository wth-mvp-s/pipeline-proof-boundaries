

## E003 — Source de version unique et non ambiguë

Toute modification traçable dans le pipeline
qui rompt l’immuabilité de l’artefact
entraîne mécaniquement la production d’une nouvelle version.

Le pipeline ne qualifie pas l’intention ;
il constate un fait :
l’artefact n’est plus identique.

---

## Changements justifiant une nouvelle version de l’artefact

1. Changements du comportement applicatif (logique métier, règles de validation)
2. Changement du contrat de données (migration du schéma de base de données, seeding ayant un impact fonctionnel)
3. Changement de l’interface publique (SPA / API) (contrat request / response, routage, endpoints)
4. Changement des exigences de sécurité (authentification, autorisation, rôles, claims, politique d’accès, mécanismes de sécurité tels que captcha ou rate limiting)

--- 


## Exemple — production et déploiement d’un artefact sans identité versionnée

Aucune information ne permet d’identifier à quelle évolution du projet correspond cet artefact ni à quel état logique du système il représente. Le pipeline constate l’existence du fichier, mais ne lui donne aucune identité versionnée

>>**La rupture d’immuabilité est possible sans changement de version détectable.**

```yaml


- script: |
    cd src
    dotnet build Application.csproj --configuration Release --no-restore
    dotnet publish Application.csproj --configuration Release \
      --output "$(Build.ArtifactStagingDirectory)/publish_output"

    cd "$(Build.ArtifactStagingDirectory)"
    zip -r application.zip publish_output/*
  displayName: 'Build and package application artefact'

- script: |
    az webapp deploy \
      --resource-group "${RESOURCE_GROUP}" \
      --name "${APP_SERVICE_NAME}" \
      --src-path "$(Build.ArtifactStagingDirectory)/application.zip" \
      --type zip
  displayName: 'Deploy application artefact'
```


## Exemple — la version est une propriété vérifiée de l’artefact

```bash

VERSION_FILE="$BUILD_ARTIFACTSTAGINGDIRECTORY/version.txt"

if [ ! -f "$VERSION_FILE" ]; then
  echo "❌ Version not defined for artefact"
  exit 1
fi

VERSION=$(cat "$VERSION_FILE")

if [ -z "$VERSION" ]; then
  echo "❌ Empty artefact version"
  exit 1
fi

echo "✅ Artefact version detected: $VERSION"
```
